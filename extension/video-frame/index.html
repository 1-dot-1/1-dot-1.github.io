<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>영상 플레이어</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      font-family: sans-serif;
    }
    /* 플레이어 컨테이너 */
    .player-container {
      width: 1200px;
      max-width: 95%;
      position: relative;
      background: #000;
      overflow: hidden;
      transform-origin: center center;
      filter: drop-shadow(0 0 6px rgba(0,0,0,0.5));
    }
    video {
      width: 100%;
      height: auto;
      display: block;
      background: #000;
    }

    /* 컨트롤 바 */
    .controls {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      display: flex;
      align-items: center;
      gap: 15px;
      background: none;
      padding: 10px 15px;
      opacity: 0;
      transform: translateY(100%);
      transition: opacity 0.3s, transform 0.3s;
    }
    .player-container.show-controls .controls {
      opacity: 1;
      transform: translateY(0);
    }

    /* 재생/일시정지 버튼 */
    .play-button {
      width: 0;
      height: 0;
      border-top: 16px solid transparent;
      border-bottom: 16px solid transparent;
      border-left: 26px solid #007BFF;
      cursor: pointer;
      filter: drop-shadow(0 0 6px rgba(0,0,0,0.5));
      transition: 0.2s;
    }
    .pause {
      border: none;
      width: 24px;
      height: 32px;
      background-image: linear-gradient(
        to right,
        #007BFF 8px,
        transparent 8px,
        transparent 16px,
        #007BFF 16px
      );
      filter: drop-shadow(0 0 6px rgba(0,0,0,0.8));
      cursor: pointer;
    }

    /* 진행 바 */
    .progress-container {
      position: relative;
      flex: 1;
      height: 10px;
      background: #999;
      border-radius: 5px;
      cursor: pointer;
      filter: drop-shadow(0 0 5px rgba(0,0,0,0.3));
    }
    .progress-buffered {
      position: absolute;
      top: 0;
      left: 0;
      width: 0%;
      height: 100%;
      background: rgba(255, 255, 255, 0.192);
      transition: width 0.2s;
      pointer-events: none;
    }
    .progress-filled {
      position: absolute;
      top: 0;
      left: 0;
      width: 0%;
      height: 100%;
      background: #007BFF;
      transition: width 0.1s;
      pointer-events: none;
    }
    .progress-thumb {
      position: absolute;
      top: 50%;
      left: 0;
      width: 14px;
      height: 14px;
      background: #2e93ff;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      filter: drop-shadow(0 2px 5px rgba(0,0,0,0.7));
      pointer-events: none;
      z-index: 2;
    }

    /* 시간 표시 */
    .time-label {
      color: #fff;
      text-shadow: 0 0 6px rgba(0,0,0,0.7);
      width: 50px;
      text-align: center;
      user-select: none;
      font-weight: bold;
    }

    /* 재생속도 조절 */
    .speed-select {
      color: #007BFF;
      background: #fff;
      border: 2px solid #007BFF;
      border-radius: 4px;
      font-size: 14px;
      padding: 4px 6px;
      outline: none;
      cursor: pointer;
      filter: drop-shadow(0 0 5px rgba(0,0,0,0.3));
    }

    /* 전체화면 버튼 */
    .fullscreen-button {
      width: 36px;
      height: 36px;
      background: #007BFF;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      filter: drop-shadow(0 0 6px rgba(0,0,0,0.8));
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .fullscreen-button:hover {
      background: #005bbd;
    }
    .fullscreen-button svg {
      width: 20px;
      height: 20px;
      transition: opacity 0.3s;
      position: absolute;
    }
    .exit-fullscreen-icon {
      opacity: 0;
    }
    .fullscreen-button.fullscreen-active .fullscreen-icon {
      opacity: 0;
    }
    .fullscreen-button.fullscreen-active .exit-fullscreen-icon {
      opacity: 1;
    }

    /* 전체화면 애니메이션 */
    .entering-fullscreen {
      animation: scale-up 0.3s forwards;
    }
    @keyframes scale-up {
      from { transform: scale(1); }
      to   { transform: scale(3); }
    }
    .exiting-fullscreen {
      animation: scale-down 0.3s forwards;
    }
    @keyframes scale-down {
      from { transform: scale(1); }
      to   { transform: scale(0.95); }
    }
  </style>
</head>
<body>

<div class="player-container" id="playerContainer">
  <video id="myVideo" preload="metadata">
    <source src="video.mp3" type="video/mp4" />
    브라우저가 video 태그를 지원하지 않습니다.
  </video>

  <div class="controls">
    <div class="play-button" id="playBtn"></div>
    <div class="progress-container" id="progressBar">
      <div class="progress-buffered" id="progressBuffered"></div>
      <div class="progress-filled" id="progressFilled"></div>
      <div class="progress-thumb" id="progressThumb"></div>
    </div>
    <div class="time-label" id="timeLabel">0:00</div>
    <select class="speed-select" id="speedSelect">
      <option value="0.5">0.5x</option>
      <option value="1" selected>1x</option>
      <option value="1.5">1.5x</option>
      <option value="2">2x</option>
    </select>
    <button class="fullscreen-button" id="fullscreenBtn">
      <svg class="fullscreen-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M3 3H9V5H5V9H3V3Z" fill="#FFF" />
        <path d="M3 21H9V19H5V15H3V21Z" fill="#FFF" />
        <path d="M15 21H21V15H19V19H15V21Z" fill="#FFF" />
        <path d="M21 3H15V5H19V9H21V3Z" fill="#FFF" />
      </svg>
      <svg class="exit-fullscreen-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M9 9H3V7H7V3H9V9Z" fill="#FFF" />
        <path d="M9 15H3V17H7V21H9V15Z" fill="#FFF" />
        <path d="M21 15H15V21H17V17H21V15Z" fill="#FFF" />
        <path d="M15 9.00012H21V7.00012H17V3.00012H15V9.00012Z" fill="#FFF" />
      </svg>
    </button>
  </div>
</div>

<script>
  const video = document.getElementById('myVideo');
  const playBtn = document.getElementById('playBtn');
  const progressBar = document.getElementById('progressBar');
  const progressBuffered = document.getElementById('progressBuffered');
  const progressFilled = document.getElementById('progressFilled');
  const progressThumb = document.getElementById('progressThumb');
  const timeLabel = document.getElementById('timeLabel');
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const playerContainer = document.getElementById('playerContainer');
  const speedSelect = document.getElementById('speedSelect');

  let isHoveringProgress = false;
  let isFullscreen = false;

  function togglePlay() {
    if (video.paused || video.ended) {
      video.play();
    } else {
      video.pause();
    }
  }

  function updatePlayButton() {
    if (video.paused) {
      playBtn.classList.remove('pause');
    } else {
      playBtn.classList.add('pause');
    }
  }

  function updateProgress() {
    if (!video.duration) return;
    const currentPercent = (video.currentTime / video.duration) * 100;
    progressFilled.style.width = currentPercent + '%';
    if (!isHoveringProgress) {
      progressThumb.style.left = currentPercent + '%';
    }
    if (video.buffered.length > 0) {
      const bufferedEnd = video.buffered.end(video.buffered.length - 1);
      const bufferedPercent = (bufferedEnd / video.duration) * 100;
      progressBuffered.style.width = bufferedPercent + '%';
    }
    timeLabel.textContent = formatTime(video.currentTime);
  }

  function seekVideo(e) {
    const rect = progressBar.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const width = rect.width;
    const seekTo = (clickX / width) * video.duration;
    video.currentTime = seekTo;
  }

  function handleProgressHover(e) {
    isHoveringProgress = true;
    const rect = progressBar.getBoundingClientRect();
    const hoverX = e.clientX - rect.left;
    const width = rect.width;
    const hoverPercent = (hoverX / width) * 100;
    progressThumb.style.left = hoverPercent + '%';
  }

  function handleProgressLeave() {
    isHoveringProgress = false;
    const currentPercent = (video.currentTime / video.duration) * 100;
    progressThumb.style.left = currentPercent + '%';
  }

  function handleSpeedChange() {
    const rate = parseFloat(speedSelect.value);
    video.playbackRate = rate;
  }

  function toggleFullscreen() {
    if (!document.fullscreenElement) {
      playerContainer.classList.remove('exiting-fullscreen');
      playerContainer.classList.add('entering-fullscreen');
      setTimeout(() => {
        playerContainer.classList.remove('entering-fullscreen');
        if (playerContainer.requestFullscreen) {
          playerContainer.requestFullscreen();
        }
      }, 300);
      isFullscreen = true;
    } else {
      playerContainer.classList.remove('entering-fullscreen');
      playerContainer.classList.add('exiting-fullscreen');
      setTimeout(() => {
        playerContainer.classList.remove('exiting-fullscreen');
        if (document.exitFullscreen) {
          document.exitFullscreen();
        }
      }, 300);
      isFullscreen = false;
    }
  }

  document.addEventListener('fullscreenchange', () => {
    if (document.fullscreenElement) {
      fullscreenBtn.classList.add('fullscreen-active');
    } else {
      fullscreenBtn.classList.remove('fullscreen-active');
    }
  });

  function formatTime(sec) {
    if (!sec || isNaN(sec)) return "0:00";
    const m = Math.floor(sec / 60);
    const s = Math.floor(sec % 60);
    return m + ":" + (s < 10 ? "0" + s : s);
  }

  function handleMouseMove(e) {
    const rect = playerContainer.getBoundingClientRect();
    const bottomThreshold = rect.bottom - 80;
    if (e.clientY >= bottomThreshold && e.clientY <= rect.bottom) {
      playerContainer.classList.add('show-controls');
    } else {
      playerContainer.classList.remove('show-controls');
    }
  }

  playBtn.addEventListener('click', togglePlay);
  video.addEventListener('play', updatePlayButton);
  video.addEventListener('pause', updatePlayButton);
  video.addEventListener('timeupdate', updateProgress);
  video.addEventListener('progress', updateProgress);
  video.addEventListener('loadedmetadata', updateProgress);
  progressBar.addEventListener('click', seekVideo);
  progressBar.addEventListener('mousemove', handleProgressHover);
  progressBar.addEventListener('mouseleave', handleProgressLeave);
  speedSelect.addEventListener('change', handleSpeedChange);
  fullscreenBtn.addEventListener('click', toggleFullscreen);
  document.addEventListener('mousemove', handleMouseMove);

  updatePlayButton();
  updateProgress();
  handleSpeedChange();
</script>
</body>
</html>
